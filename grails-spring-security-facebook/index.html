<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Igor Artamonov">
<meta name="copyright" content="Apache License, Version 2.0">
<title>Spring Security Facebook Plugin - Reference Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Spring Security Facebook Plugin - Reference Documentation</h1>
<div class="details">
<span id="author" class="author">Igor Artamonov</span><br>
<span id="revnumber">version 0.18</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#requirements">1.1. Requirements</a></li>
<li><a href="#links">1.2. Links</a></li>
</ul>
</li>
<li><a href="#install-plugin">2. Install plugin</a>
<ul class="sectlevel2">
<li><a href="#upgrade-notes">2.1. Upgrade Notes</a></li>
</ul>
</li>
<li><a href="#usage">3. Usage</a>
<ul class="sectlevel2">
<li><a href="#example-app">3.1. Example app</a></li>
<li><a href="#filters">3.2. Filters</a></li>
<li><a href="#filter-type-configuration">3.3. Filter Type configuration</a></li>
<li><a href="#service-side">3.4. Service Side</a></li>
<li><a href="#client-side-authentication-2">3.5. Client Side Authentication</a></li>
<li><a href="#json-authentication">3.6. Json Authentication</a></li>
</ul>
</li>
<li><a href="#configuration">4. Configuration</a>
<ul class="sectlevel2">
<li><a href="#basic-configuration">4.1. Basic Configuration</a></li>
<li><a href="#configure-facebook-app">4.2. Configure Facebook App</a></li>
<li><a href="#configure-domains">4.3. Configure Domains</a></li>
<li><a href="#configure-login-button">4.4. Configure Login Button</a></li>
<li><a href="#configure-plugin">4.5. Configure Plugin</a></li>
<li><a href="#configure-authentication-types">4.6. Configure Authentication Types</a></li>
</ul>
</li>
<li><a href="#customization">5. Customization</a>
<ul class="sectlevel2">
<li><a href="#how-it-works-2">5.1. How it works</a></li>
<li><a href="#default-implementation">5.2. Default Implementation</a></li>
</ul>
</li>
<li><a href="#how-to">6. How To</a>
<ul class="sectlevel2">
<li><a href="#how-to-2">6.1. How To</a></li>
</ul>
</li>
<li><a href="#common-issues">7. Common Issues</a>
<ul class="sectlevel2">
<li><a href="#debug">7.1. Debug</a></li>
<li><a href="#issues">7.2. Issues</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="requirements">1.1. Requirements</h3>
<div class="ulist">
<ul>
<li>
<p>Grails 3.0</p>
</li>
<li>
<p>spring-security-core plugin 3.0.0</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="links">1.2. Links</h3>
<div class="ulist">
<ul>
<li>
<p>Sources - <a href="https://github.com/splix/grails-spring-security-facebook" class="bare">https://github.com/splix/grails-spring-security-facebook</a></p>
</li>
<li>
<p>Sample App - <a href="https://github.com/splix/grails-facebook-authentication-example" class="bare">https://github.com/splix/grails-facebook-authentication-example</a></p>
</li>
<li>
<p>if you found a bug - please submit it into <a href="https://github.com/splix/grails-spring-security-facebook/issues" class="bare">https://github.com/splix/grails-spring-security-facebook/issues</a></p>
</li>
<li>
<p>other questions please ask at StackOverflow - <a href="http://stackoverflow.com/questions/tagged/grails" class="bare">http://stackoverflow.com/questions/tagged/grails</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-plugin">2. Install plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basically it&#8217;s just adding dependency into <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dependencies {

    compile 'org.grails.plugins:spring-security-facebook:0.18'

}</pre>
</div>
</div>
<div class="paragraph">
<p>Follow Configuration and Basic Usage sections for next steps.</p>
</div>
<div class="sect2">
<h3 id="upgrade-notes">2.1. Upgrade Notes</h3>
<div class="sect3">
<h4 id="upgrading-from-version-0-9">2.1.1. Upgrading from version 0.9</h4>
<div class="paragraph">
<p>Since version 0.10 plugin have started to use Server Side authentication by default, instead of
Client Side authentication (based on Facebook JS SDK) that was default implementation for version 0.9 and earlier.</p>
</div>
<div class="paragraph">
<p>If you want to continue using Client Side authentication, you should add following configuration into <code>application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                filter:
                    type:
                        - transparent
                        - cookieDirect</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="upgrading-from-version-0-15-x">2.1.2. Upgrading from version 0.15.x</h4>
<div class="paragraph">
<p>Version 0.16 requires a Spring Security Core 2.0, you need to upgrade to this version of core plugin.</p>
</div>
</div>
<div class="sect3">
<h4 id="upgrade-from-version-0-17-x">2.1.3. Upgrade from version 0.17.x</h4>
<div class="paragraph">
<p>Version 0.18 is based on Grails 3.0 and Spring Security Core 3.0</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage">3. Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="example-app">3.1. Example app</h3>
<div class="paragraph">
<p>You can take a look at <a href="https://github.com/splix/grails-facebook-authentication-example">Example Application</a>, it&#8217;s very
basic app, that have only one page, with 'Facebook Connect' button. Just clone it, put your FB App credentials, and play with it.</p>
</div>
<div class="sect3">
<h4 id="add-facebook-authentication-into-your-existing-application">3.1.1. Add Facebook Authentication into your existing application</h4>
<div class="sect4">
<h5 id="initial-plugin-config">Initial plugin config</h5>
<div class="sect5">
<h6 id="domain-class">Domain Class</h6>
<div class="paragraph">
<p>Create domain class for your facebook user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class FacebookUser {
  Long uid
  String accessToken
  Date accessTokenExpires

  static belongsTo = [user: User] //connected to main Spring Security domain

  static constraints = {
    uid unique: true
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>At <code>conf/application.yml</code> setup full name (including package name, if used) of just created Facebook user domain, like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                domain:
                    classname: 'FacebookUser'</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="add-fb-app-credentials">Add FB App credentials</h6>
<div class="paragraph">
<p>You should create a Facebook App and copy App ID and Secret:</p>
</div>
<div class="paragraph">
<p>!create_app.png!</p>
</div>
<div class="paragraph">
<p>into <code>conf/application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                appId: 12345678900000
                secret: 76c2279743c99da3715e3d00f29a1234</pre>
</div>
</div>
<div class="paragraph">
<p>PS it&#8217;s just example, you should use your own <code>appId</code> and <code>secret</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="add-facebook-connect-button">Add Facebook Connect button</h6>
<div class="paragraph">
<p>There is special taglib (<code>&lt;facebookAuth:</code>) that can be used at your view (any GSP page) to add Facebook Connect button.</p>
</div>
<div class="paragraph">
<p>Following code displays connect button for not authorized user, or show a welcome message to logged in user:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;sec:ifNotGranted roles="ROLE_USER"&gt;
  &lt;facebookAuth:connect /&gt;
&lt;/sec:ifNotGranted&gt;
&lt;sec:ifAllGranted roles="ROLE_USER"&gt;
  Welcome &lt;sec:username/&gt;! (&lt;g:link uri="/j_spring_security_logout"&gt;Logout&lt;/g:link&gt;)
&lt;/sec:ifAllGranted&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="run">Run</h5>
<div class="paragraph">
<p>That&#8217;s it! Run your application, and test that everything is working.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails run-app</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="filters">3.2. Filters</h3>
<div class="sect3">
<h4 id="how-it-works">3.2.1. How it works</h4>
<div class="paragraph">
<p>Plugin is based on Spring Security and uses web filters for authorization, for more details see
<a href="http://static.springsource.org/spring-security/site/docs/3.0.x/reference/security-filter-chain.html">Spring Security docs</a></p>
</div>
<div class="sect4">
<h5 id="available-filters">Available filters</h5>
<div class="paragraph">
<p>There are 4 types of filter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>FacebookAuthRedirectFilter - server-side authorization (used by default)</p>
</li>
<li>
<p>FacebookAuthCookieTransparentFilter - automatic client-side authorization</p>
</li>
<li>
<p>FacebookAuthCookieDirectFilter - manual client-side authorization</p>
</li>
<li>
<p>FacebookAuthJsonFilter - for external clients (like Android/iOS app)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="server-side-authentication-facebookauthredirectfilter">Server-Side authentication (FacebookAuthRedirectFilter)</h5>
<div class="paragraph">
<p>It&#8217;s a standard <a href="https://developers.facebook.com/docs/howtos/login/server-side-login/">Login for Server-side Apps</a>.
After clicking on 'connect button' user gets redirected to special Facebook page, for authentication, and then
redirected back to your app.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="client-side-authentication">3.2.2. Client-Side authentication</h4>
<div class="sect4">
<h5 id="transparent-cookie-based-authorization-facebookauthcookietransparentfilter">Transparent cookie based authorization (FacebookAuthCookieTransparentFilter)</h5>
<div class="paragraph">
<p>Based on <a href="https://developers.facebook.com/docs/reference/javascript/">Facebook Javascript SDK</a> authorization. On
client side it makes Facebook authorization and put Facebook Cookie (it&#8217;s made by Facebook Javascript,
you don&#8217;t need anything special)</p>
</div>
<div class="paragraph">
<p>After successful authorization on client side, the browser should reload current page. Or open any other page.</p>
</div>
<div class="paragraph">
<p>This filter will <strong>process each request</strong>, and if it sees valid Facebook cookie, it makes authorization for
current user. If it&#8217;s a new user, it creates a new one for application, with provided Facebook credentials.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It&#8217;s per-request authorization. That means that this filter will try to authorize user on each page request.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="manual-cookie-based-authentication-facebookauthcookiedirectfilter">Manual cookie based authentication (FacebookAuthCookieDirectFilter)</h5>
<div class="paragraph">
<p>Based on <a href="https://developers.facebook.com/docs/reference/javascript/">Facebook Javascript SDK</a> authorization. On
client side it makes Facebook authorization and put Facebook Cookie (it&#8217;s made by Facebook Javascript,
you don&#8217;t need anything special)</p>
</div>
<div class="paragraph">
<p>Same as FacebookAuthCookieTransparentFilter, it parse Facebook cookie, but only for specified url. Like
username/password filter from spring-security-core or similar. After successful authorization it
can redirect user to specified url.</p>
</div>
</div>
<div class="sect4">
<h5 id="json-or-android-ios-desktop-authorization-facebookauthjsonfilter">JSON or Android/iOS/desktop authorization (FacebookAuthJsonFilter)</h5>
<div class="paragraph">
<p>Client should send Access Token or Signed Request as parameter, and will get JSON response with user details.</p>
</div>
<div class="paragraph">
<p>See [filter docs|guide:3.5 Json Authentication]</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="filter-type-configuration">3.3. Filter Type configuration</h3>
<div class="paragraph">
<p>You can use config parameter <code>grails.plugin.springsecurity.facebook.filter.type</code> to configure which filters
you want to use in your application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>It's not a Spring Security configuration, not a configuration for Spring filters. Just a
extra configuration, that used only by this plugin.</pre>
</div>
</div>
<div class="paragraph">
<p>By default it uses only one 'redirect' filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                filter:
                    type: redirect</pre>
</div>
</div>
<div class="paragraph">
<p>You can use more that one filter at same time:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                filter:
                    type:
                        - transparent
                        - cookieDirect</pre>
</div>
</div>
<div class="paragraph">
<p>Value types:
  * <code>redirect</code> - use standard server side authorization
  * <code>transparent</code> - use transparent cookie based authorization
  * <code>cookieDirect</code> - use manual cookie based authorization
  * <code>json</code> - use JSON authorization</p>
</div>
</div>
<div class="sect2">
<h3 id="service-side">3.4. Service Side</h3>
<div class="paragraph">
<p>It&#8217;s the <code>FacebookAuthRedirectFilter</code>, enabled by default.</p>
</div>
<div class="paragraph">
<p>It&#8217;s preferred and a standard <a href="https://developers.facebook.com/docs/howtos/login/server-side-login/">Login for Server-side Apps</a>.
After clicking on 'connect button' user gets redirected to special Facebook page, for authentication, and then
redirected back to your app.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>User going to see Facebook Authentication screen only at the first time. Next time user will be redirected
back from Facebook to your application immediately.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="how-to-process-failed-login">3.4.1. How to process failed login</h4>
<div class="paragraph">
<p>When user declines Facebook Authentication (click Cancel, for example), you&#8217;ll '401 Authentication Failed' by default.
It&#8217;s default configuration of Spring Security failure handler, but for most cases it&#8217;s not what you really want.</p>
</div>
<div class="paragraph">
<p>To handle this situation you have to create your own Failure Handler, a bean implementing
<code>org.springframework.security.web.authentication.AuthenticationFailureHandler</code>. If you just need to
show a page (a GSP view), you can use standard <code>SimpleUrlAuthenticationFailureHandler</code>, that could redirect
failed authentication to specified URL.</p>
</div>
<div class="paragraph">
<p>For example you can create bean at <code>resources.groovy</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler

// Place your Spring DSL code here
beans = {

    redirectFailureHandlerExample(SimpleUrlAuthenticationFailureHandler) {
        defaultFailureUrl = '/failed' //redirect to this URL when authentication fails
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>and setup this bean for 'redirect' filter at <code>application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                filter:
                    redirect:
                        failureHandler: redirectFailureHandlerExample</pre>
</div>
</div>
<div class="paragraph">
<p>Same way for configuring Success Handler.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="client-side-authentication-2">3.5. Client Side Authentication</h3>
<div class="paragraph">
<p>Based on <a href="https://developers.facebook.com/docs/javascript">Facebook Javascript SDK</a> authorization. Useful
when you need to use FB Javascript SDK on client side.</p>
</div>
<div class="paragraph">
<p>And there are two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>try authenticate user on each request, to any page - it&#8217;s <code>transparent</code> filter</p>
</li>
<li>
<p>authenticate only when user redirected to specified page, like a standard username/password authentication - it&#8217;s <code>cookieDirect</code> filter</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="transparent-filter">3.5.1. Transparent filter</h4>
<div class="paragraph">
<p>If you&#8217;re using first way (<code>transparent</code> filter), your user will be automatically authenticated whenever he has
Facebook cookie. Btw, don&#8217;t forget that you should <strong>reload</strong> current page after you have successfully authenticated user
on client side. Like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;facebookAuth:init&gt;
   FB.Event.subscribe('auth.login', function() {
      window.location.reload();
   });
&lt;/facebookAuth:init&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>To logout user, simply call <code>FB.logout()</code> (using Javascript) on client side.</p>
</div>
</div>
<div class="sect3">
<h4 id="cookiedirect-filter">3.5.2. CookieDirect filter</h4>
<div class="paragraph">
<p>If you&#8217;re using second way (<code>cookieDirect</code> filter), you could configure URL that will be used for authentication at <code>application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                filter:
                    processUrl: '/j_spring_security_facebook_check' # it's default value</pre>
</div>
</div>
<div class="paragraph">
<p>And after authorization redirect user to <code>/j_spring_security_facebook_check</code>, like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;facebookAuth:init&gt;
   FB.Event.subscribe('auth.login', function() {
      window.location.href = '/j_spring_security_facebook_check'
   });
&lt;/facebookAuth:init&gt;

&lt;g:javascript&gt;
   $('#fbloginbutton').click(function() {
       FB.login();
   });
&lt;/g:javascript&gt;</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="json-authentication">3.6. Json Authentication</h3>
<div class="paragraph">
<p>Filter 'FacebookAuthJsonFilter' accepts Facebook Access Token or Signed Request as parameter, and responds
 with JSON to authorization requests. It&#8217;s useful if you an external client for your Grails application, it
 could be Android or iOS application, or Desktop application, or just AJAX client.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>JSON filter just returns an object with user details, nothing else. For authentication of other requests,
you still have to use different filter. If you have a RESTful client, take a look at
<a href="http://grails.org/plugin/spring-security-oauth2-provider">spring-security-oauth2-provider plugin</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>How it works:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; GET /j_spring_security_facebook_json?access_token=&lt;ACCESS_TOKEN&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For successful authorization you&#8217;ll get:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt; HTTP/1.1 200 OK
&lt; Content-Type: application/json;charset=UTF-8
&lt;
{
  "authenticated": true,
  "uid": 12345612345,   # Facebook User Id
  "roles":[
     "ROLE_FACEBOOK",
     "ROLE_USER"
  ],
  "username": "facebook_12345612345", # Grails Application User Id/Username
  "enabled": true # Grails Application User status
}</pre>
</div>
</div>
<div class="paragraph">
<p>For unsuccessful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt; HTTP/1.1 401 Unauthorized
&lt; Content-Type: application/json;charset=UTF-8
&lt;
{
  "authenticated": false,
  "message": "Expired token" # Authentication Failure reason
}</pre>
</div>
</div>
<div class="sect3">
<h4 id="how-to-extend-json-response">3.6.1. How to extend JSON response</h4>
<div class="paragraph">
<p>The plugin going to call <code>Map onJsonSuccess(Map input, FacebookAuthToken token)</code>
or <code>Map onJsonFailure(Map input, AuthenticationException exception)</code> methods
of FacebookAuthService (if exists).</p>
</div>
<div class="paragraph">
<p>There you can update <code>input</code> data with any other values, introduce new fields/keys, or even return your
own structure. This structure will be transformed to JSON and sent to client.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration">4. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="basic-configuration">4.1. Basic Configuration</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Make sure that you have installed and configured spring-security-core plugin before this step.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Most default configuration will look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    plugin:
        springsecurity:
            facebook:
                domain:
                    classname: '&lt;your FacebookUser domain&gt;'
                secret: '&lt;Facebook secret for your app&gt;'
                appId: '&lt;Facebooks's app ID&gt;'</pre>
</div>
</div>
<div class="paragraph">
<p>When you have valid configuration you can put Facebook Connect button in you GSP:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;facebookAuth:connect permissions="email,user_about_me"/&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>You don&#8217;t need to add anything else.</p>
</div>
</div>
<div class="sect2">
<h3 id="configure-facebook-app">4.2. Configure Facebook App</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.appId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.apiVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>apiVersion</code> - Facebook API version (e.g., "v2.2"). If not set is used unversioned Facebook API by default.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.permissions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['email']</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For a list of all possible permissions see <a href="https://developers.facebook.com/docs/reference/login/#permissions" class="bare">https://developers.facebook.com/docs/reference/login/#permissions</a></p>
</div>
</div>
<div class="sect2">
<h3 id="configure-domains">4.3. Configure Domains</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Values</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.domain.classname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'FacebookUser'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.domain.appUserConnectionPropertyName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'user'</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>domain.classname</code> - name of your domain class, used to store Facebook User details (uid, access_token, etc).
Could be same as configured for Spring Security Core, or a own domain, just for Facebook User details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you&#8217;re using own domain for Facebook user (a joined to main User) you should
specify <code>domain.appUserConnectionPropertyName</code>: it&#8217;s how your domain class is related
to main (used by Spring Security Core) user domain. It&#8217;s the name
of the property, usually defined as <code>static belongsTo = [user: User]</code> in your Facebook User domain class.</p>
</div>
<div class="sect3">
<h4 id="user-creation-initialization">4.3.1. User creation/initialization</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.autoCreate.roles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['ROLE_USER', 'ROLE_FACEBOOK']</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>List of roles for user created by the plugin.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configure-login-button">4.4. Configure Login Button</h3>
<div class="sect3">
<h4 id="button-configuration">4.4.1. Button configuration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.taglib.button.text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Login with Facebook'</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="button-for-server-side-authentication-default">4.4.2. Button for Server Side authentication (default)</h4>
<div class="paragraph">
<p>Standard <code>&lt;img &#8230;&#8203; /&gt;</code> will be used for button, with following extra configuration options:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.taglib.button.img</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">an url for image distributed with plugin</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>img</code> - url of a default image to use for button</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="button-for-client-side-authentication">4.4.3. Button for Client Side authentication</h4>
<div class="paragraph">
<p>At this case a HTML button, provided by Facebook JS SDK, will be user.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.taglib.language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'en_US'</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>language</code> - language for Facebook Javascript SDK. You could also pass this option as a <code>lang</code> attribute for <code>:connect</code> or <code>:init</code> tags</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configure-plugin">4.5. Configure Plugin</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.autoCreate.enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.autoCreate.roles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['ROLE_USER', 'ROLE_FACEBOOK']</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>autoCreate.enabled</code> - enable/disabled automatic creation of Application User for a new Facebook user (when FB user first time authenticates)</p>
</li>
<li>
<p><code>autoCreate.roles</code> - list of roles to set to a newly created user (if enabled)</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Set a hostname of current app, could be used when user logged out, but FB didn&#8217;t clear all cookies for domain. Note: it&#8217;s
host name, not url. Like <code>example.com</code></p>
</div>
</div>
<div class="sect2">
<h3 id="configure-authentication-types">4.6. Configure Authentication Types</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.processUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'/j_spring_security_facebook_check'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'redirect'</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>type</code> - type of authentication, can be <code>transparent</code>, <code>cookieDirect</code>, <code>redirect</code> or <code>json</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can specify list of filters as a list <code>['redirect', 'json']</code> or comma-separated string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails.plugin.springsecurity.facebook.filter.type='redirect,json'</pre>
</div>
</div>
<div class="sect3">
<h4 id="configuration-for-redirect-filter">4.6.1. Configuration for REDIRECT filter</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.redirect.processUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.redirect.redirectFromUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'/j_spring_security_facebook_redirect'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.redirect.failureHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.redirect.successHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>redirectFromUrl</code> - it&#8217;s the url that will redirect user to special Facebook Authentication URL. You can put link to/redirect user to <code>redirectFromUrl</code> when you want to use Facebook authentication. This url is used by default <code>&lt;facebook:connect /&gt;</code> button.</p>
</li>
<li>
<p>if <code>filter.redirect.processUrl</code> is not then, then default <code>filter.processUrl</code> will be used</p>
</li>
<li>
<p><code>failureHandler</code> - a name of the bean that implements [AuthenticationFailureHandler|http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/AuthenticationFailureHandler.html]</p>
</li>
<li>
<p><code>successHandler</code> - a name of the bean that implements [AuthenticationSuccessHandler|http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/AuthenticationSuccessHandler.html]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-for-transparent-filter">4.6.2. Configuration for TRANSPARENT filter</h4>
<div class="paragraph">
<p>NA</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-for-cookiedirect-filter">4.6.3. Configuration for COOKIEDIRECT filter</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.cookieDirect.processUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.cookieDirect.failureHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.cookieDirect.successHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not set</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>if <code>filter.cookieDirect.processUrl</code> is not set, then default <code>filter.processUrl</code> will be used</p>
</li>
<li>
<p><code>failureHandler</code> - a name of the bean that implements [AuthenticationFailureHandler|http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/AuthenticationFailureHandler.html]</p>
</li>
<li>
<p><code>successHandler</code> - a name of the bean that implements [AuthenticationSuccessHandler|http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/AuthenticationSuccessHandler.html]</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-for-json-filter">4.6.4. Configuration for JSON filter</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Default Value</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.json.processUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'/j_spring_security_facebook_json'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.json.type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'json'</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.plugin.springsecurity.facebook.filter.json.methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">['POST']</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p><code>type</code> could be <code>json</code> (default) or <code>jsonp</code></p>
</li>
<li>
<p><code>methods</code> - allowed HTTP methods. Notice that it&#8217;s used only for JSON, for JSONP it will be forced to 'GET'</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="customization">5. Customization</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="how-it-works-2">5.1. How it works</h3>
<div class="paragraph">
<p>If you need to add some specific logic to default plugin behaviour you have to create your own
service called <code>FacebookAuthService</code>. Plugin will check for know methods of this service, and if
they&#8217;re exist - use them instead of own.</p>
</div>
<div class="paragraph">
<p>It&#8217;s some kind of extending an abstract class. You don&#8217;t need to create all methods, just what you need.</p>
</div>
<div class="paragraph">
<p>Used objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;FacebookUser&gt; - domain class for your facebook user. It&#8217;s your own class, can have other name, it&#8217;s just a example</p>
</li>
<li>
<p>&lt;Person&gt; - general user, used by Spring Security. It&#8217;s your own class, can have other name, it&#8217;s just a example</p>
</li>
<li>
<p>FacebookAuthToken - token provided by plugin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&lt;FacebookUser&gt; and &lt;Person&gt; can be same object, or can be two different object (with a relation), depends
on your architecture.</p>
</div>
</div>
<div class="sect2">
<h3 id="default-implementation">5.2. Default Implementation</h3>
<div class="paragraph">
<p>Please, take a look at sources of [DefaultFacebookAuthDao|https://github.com/splix/grails-spring-security-facebook/blob/master/src/groovy/com/the6hours/grails/springsecurity/facebook/DefaultFacebookAuthDao.groovy]
to understand how it works, and which methods you can use for customization</p>
</div>
<div class="sect3">
<h4 id="list-of-possible-methods">5.2.1. List of possible methods:</h4>
<div class="sect4">
<h5 id="void-oncreate-facebookuser-user-facebookauthtoken-token">void onCreate(&lt;FacebookUser&gt; user, FacebookAuthToken token)</h5>
<div class="paragraph">
<p>Called after user was created by plugin, just before saving into database. You can fill user object
with some extra values.</p>
</div>
<div class="paragraph">
<p>Not called if you have implemented method @create(..)@</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user - your domain for Facebook User</p>
</li>
<li>
<p>token - com.the6hours.grails.springsecurity.facebook.FacebookAuthToken</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="void-aftercreate-facebookuser-user-facebookauthtoken-token">void afterCreate(&lt;FacebookUser&gt; user, FacebookAuthToken token)</h5>
<div class="paragraph">
<p>Called after user was created by plugin, and when it&#8217;s already saved into database.</p>
</div>
<div class="paragraph">
<p>Not called if you have implemented method @create(..)@</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user - your domain for Facebook User</p>
</li>
<li>
<p>token - com.the6hours.grails.springsecurity.facebook.FacebookAuthToken</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="facebookuser-finduser-long-uid">&lt;FacebookUser&gt; findUser(long uid)</h5>
<div class="paragraph">
<p>Called when facebook user is authenticated (on every request), must return existing instance
for specified facebook uid, if exits. If doesn&#8217;t - return null</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>uid - facebook user id</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="facebookuser-create-facebookauthtoken-token">&lt;FacebookUser&gt; create(FacebookAuthToken token)</h5>
<div class="paragraph">
<p>Called when we have a new facebook user, called on first login to create all required
data structures.</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>token - com.the6hours.grails.springsecurity.facebook.FacebookAuthToken</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notice, that if you have such method, all other method for user creation will no be called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>createAppUser</p>
</li>
<li>
<p>prepopulateAppUser</p>
</li>
<li>
<p>onCreate</p>
</li>
<li>
<p>afterCreate</p>
</li>
<li>
<p>createRoles</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="person-createappuser-facebookuser-user-facebookauthtoken-token">&lt;Person&gt; createAppUser(&lt;FacebookUser&gt; user, FacebookAuthToken token)</h5>
<div class="paragraph">
<p>Called when we have a new facebook user, called on first login to create main app User domain (when
we store Facebook User details in different domain).</p>
</div>
<div class="paragraph">
<p>Not called if you have implemented method @create(..)@</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user - your domain for Facebook User</p>
</li>
<li>
<p>token - com.the6hours.grails.springsecurity.facebook.FacebookAuthToken</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="void-createroles-facebookuser-user">void createRoles(&lt;FacebookUser&gt; user)</h5>
<div class="paragraph">
<p>Called when we have a new facebook user, called on first login to create roles list for new user</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user - your domain for Facebook User</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="def-getprincipal-facebookuser-user">def getPrincipal(&lt;FacebookUser&gt; user)</h5>
<div class="paragraph">
<p>Must return object to store in security context for specified facebook user (can return itself)</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user - your domain for Facebook User</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="facebookuser-getfacebookuser-person-person">&lt;FacebookUser&gt; getFacebookUser(&lt;Person&gt; person)</h5>
<div class="paragraph">
<p>Must return instance of your domain object for facebook user for specified person (if it&#8217;s not a same object)</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>person - your domain for &lt;Person&gt;</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="collection-grantedauthority-getroles-person-user">Collection&lt;GrantedAuthority&gt; getRoles(&lt;Person&gt; user)</h5>
<div class="paragraph">
<p>Must return roles list for specified user</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user - your domain for Facebook User</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="void-prepopulateappuser-person-person-facebookauthtoken-token">void prepopulateAppUser(&lt;Person&gt; person, FacebookAuthToken token)</h5>
<div class="paragraph">
<p>Must return roles list for specified facebook user</p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>person - your domain for &lt;Person&gt;</p>
</li>
<li>
<p>token - com.the6hours.grails.springsecurity.facebook.FacebookAuthToken</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-to">6. How To</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="how-to-2">6.1. How To</h3>
<div class="sect3">
<h4 id="how-to-get-user-full-name-and-or-email">6.1.1. How to get user full name and/or email?</h4>
<div class="paragraph">
<p>Main goal of the plugin is to make authorization. All other usage of Facebook API should be done by
using additional library, <a href="http://www.springsource.org/spring-social">Spring Social</a> for example.</p>
</div>
<div class="paragraph">
<p>First of all: you need 'email' permission on connect <code>&lt;facebookAuth:connect permissions="email"/&gt;</code></p>
</div>
<div class="paragraph">
<p>Add Spring Social lib into your classpath, by adding following dependencies into your <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>compile 'org.springframework.social:spring-social-facebook:2.0.3.RELEASE'</pre>
</div>
</div>
<div class="paragraph">
<p>and then you can use Facebook API. For example you can fetch user email and full name on user creation step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def facebook = new FacebookTemplate(token.accessToken.accessToken)
def fbProfile = facebook.userOperations().userProfile
String email = fbProfile.email
String name = fbProfile.name</pre>
</div>
</div>
<div class="paragraph">
<p>See documentations for Spring Social Facebook: <a href="http://docs.spring.io/spring-social-facebook/docs/2.0.3.RELEASE/reference/htmlsingle/#retrieving-a-user-s-profile-data" class="bare">http://docs.spring.io/spring-social-facebook/docs/2.0.3.RELEASE/reference/htmlsingle/#retrieving-a-user-s-profile-data</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="common-issues">7. Common Issues</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="debug">7.1. Debug</h3>
<div class="sect3">
<h4 id="enable-logging">7.1.1. Enable logging</h4>
<div class="paragraph">
<p>If you have troubles with plugin, please enabled logging, so you can see what&#8217;s happening. Add to <code>logback.groovy</code> following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>logger("com.the6hours", DEBUG, ["CONSOLE"])</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="issues">7.2. Issues</h3>
<div class="sect3">
<h4 id="client-side-authentication-don-t-work-on-dev-server">7.2.1. Client side authentication don&#8217;t work on dev server</h4>
<div class="paragraph">
<p>Make sure that you&#8217;re using a real domain name for your application. Not a <code>localhost</code>, because Facebook can&#8217;t setup
cookie for localhost, and avoid .local domains as well.</p>
</div>
<div class="paragraph">
<p>You can make a fake domain like myapp.dev, by putting into <code>/etc/hosts</code> the following line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>127.0.0.1  myapp.dev</pre>
</div>
</div>
<div class="paragraph">
<p>If you already have line starting with <code>127.0.0.1</code>, just add your <code>myapp.dev</code> at the end of the line.</p>
</div>
<div class="paragraph">
<p>See more details about hosts file, and location of the file for different operation systems see: <a href="http://en.wikipedia.org/wiki/Hosts_(file" class="bare">http://en.wikipedia.org/wiki/Hosts_(file</a>)</p>
</div>
<div class="paragraph">
<p>After that, you should configure your Grails app to use this domain, by adding following line into <code>conf/application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>grails:
    serverURL: "http://myapp.dev:8080/${appName}"</pre>
</div>
</div>
<div class="paragraph">
<p>Of course, you need to use this domain only for development, so put this configuration into <code>development</code>
environment config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>environments:
    development:
        grails:
            serverURL: "http://myapp.dev:8080/${appName}"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="logout-doesn-t-work-for-transparent-filter">7.2.2. Logout doesn&#8217;t work for Transparent filter</h4>
<div class="paragraph">
<p>"transparent" filter always authorize request that contains FB cookie. If you need to log out current user when using
this type of filter, you need to log out user on client side, call <code>FB.logout()</code> (will logout user from Facebook
as well) and reload the page.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.18<br>
Last updated 2016-02-13 22:23:25 OMST
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>